query subscriptionBillingCycles(
  $first: Int!
  $reverse: Boolean!
  $contractId: ID!
  $startDate: DateTime!
  $endDate: DateTime!
) {
  subscriptionBillingCycles(
    first: $first
    reverse: $reverse
    contractId: $contractId
    billingCyclesDateRangeSelector: { startDate: $startDate, endDate: $endDate }
  ) {
    edges {
      node {
        __typename
        billingAttemptExpectedDate
        cycleEndAt
        cycleIndex
        cycleStartAt
        edited
        editedContract {
          __typename
          app {
            id
          }
          appAdminUrl
          createdAt
          currencyCode
          customAttributes {
            key
            value
          }
          customer {
            id
          }
          customerPaymentMethod {
            id
          }
          deliveryPrice {
            amount
            currencyCode
          }
          linesCount {
            count
            precision
          }
          note
          price: priceBreakdownEstimate {
            subtotalPrice {
              amount
              currencyCode
            }
            taxesIncluded
            totalDiscounts {
              amount
              currencyCode
            }
            totalPrice {
              amount
              currencyCode
            }
            totalShippingPrice {
              amount
              currencyCode
            }
            totalTax {
              amount
              currencyCode
            }
          }
          lines(first: 20) {
            edges {
              node {
                __typename
                id
                currentPrice {
                  amount
                  currencyCode
                }
                customAttributes {
                  key
                  value
                }
                discountAllocations {
                  amount {
                    amount
                    currencyCode
                  }
                  discount {
                    ... on SubscriptionAppliedCodeDiscount {
                      id
                      redeemCode
                      rejectionReason
                    }
                    ... on SubscriptionManualDiscount {
                      entitledLines {
                        all
                      }
                      id
                      recurringCycleLimit
                      rejectionReason
                      targetType
                      title
                      type
                      usageCount
                      value {
                        ... on SubscriptionDiscountFixedAmountValue {
                          amount {
                            amount
                            currencyCode
                          }
                          appliesOnEachItem
                        }
                        ... on SubscriptionDiscountPercentageValue {
                          percentage
                        }
                      }
                    }
                  }
                }
                lineDiscountedPrice {
                  amount
                  currencyCode
                }
                pricingPolicy {
                  basePrice {
                    amount
                    currencyCode
                  }
                  cycleDiscounts {
                    adjustmentType
                    adjustmentValue {
                      ... on MoneyV2 {
                        amount
                        currencyCode
                      }
                      ... on SellingPlanPricingPolicyPercentageValue {
                        percentage
                      }
                    }
                    afterCycle
                    computedPrice {
                      amount
                      currencyCode
                    }
                  }
                }
                productId
                quantity
                requiresShipping
                sellingPlanId
                sellingPlanName
                sku
                taxable
                title
                variantId
                variantTitle
              }
            }
          }
          updatedAt
        }
        skipped
        sourceContract {
          id
        }
        status
      }
    }
  }
}
